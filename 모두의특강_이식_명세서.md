# ëª¨ë‘ì˜íŠ¹ê°• ì›¹ ì‹œìŠ¤í…œ ì´ì‹ ëª…ì„¸ì„œ v1.0

> **ëª©ì **: ì´ë²¤íŠ¸ ê¸°ë°˜ ì§ˆë¬¸ ë­í‚¹ ë° ì•„ì¹´ì´ë¹™ í”Œë«í¼ ì´ì‹ ëª…ì„¸ì„œ  
> **ëŒ€ìƒ**: ì§ˆë¬¸/ë‹µë³€ ë³´ë“œ, íˆ¬í‘œ ì‹œìŠ¤í…œ, AI í”„ë¡¬í”„íŠ¸ ë³µì‚¬, NotebookLM ì—°ë™, ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ  
> **ì‘ì„±ì¼**: 2025-01-XX

---

## ğŸ“‹ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#1-ì‹œìŠ¤í…œ-ê°œìš”)
2. [ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì²˜](#2-ê¸°ìˆ -ìŠ¤íƒ-ë°-ì•„í‚¤í…ì²˜)
3. [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#3-ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
4. [ì§ˆë¬¸/ë‹µë³€ ë³´ë“œ ì‹œìŠ¤í…œ](#4-ì§ˆë¬¸ë‹µë³€-ë³´ë“œ-ì‹œìŠ¤í…œ)
5. [íˆ¬í‘œ ë° ë­í‚¹ ì‹œìŠ¤í…œ](#5-íˆ¬í‘œ-ë°-ë­í‚¹-ì‹œìŠ¤í…œ)
6. [ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ ì‹œìŠ¤í…œ](#6-ì–´ë“œë¯¼-ëŒ€ì‹œë³´ë“œ-ì‹œìŠ¤í…œ)
7. [SEO ê´€ë¦¬ ì‹œìŠ¤í…œ](#7-seo-ê´€ë¦¬-ì‹œìŠ¤í…œ)
8. [ì¸ì¦ ë° ê¶Œí•œ ê´€ë¦¬](#8-ì¸ì¦-ë°-ê¶Œí•œ-ê´€ë¦¬)
9. [íŠ¸ë˜í‚¹ ë° ë¶„ì„ ì‹œìŠ¤í…œ](#9-íŠ¸ë˜í‚¹-ë°-ë¶„ì„-ì‹œìŠ¤í…œ)
10. [API ëª…ì„¸](#10-api-ëª…ì„¸)
11. [í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°](#11-í”„ë¡ íŠ¸ì—”ë“œ-ì»´í¬ë„ŒíŠ¸-êµ¬ì¡°)
12. [ì´ì‹ ê°€ì´ë“œ](#12-ì´ì‹-ê°€ì´ë“œ)

---

## 1. ì‹œìŠ¤í…œ ê°œìš”

### 1.1 í”„ë¡œì íŠ¸ êµ¬ì¡°

- **í”„ë¡œì íŠ¸ëª…**: ëª¨ë‘ì˜íŠ¹ê°• ì›¹ ì‹œìŠ¤í…œ
- **ê¸°ë°˜ í”„ë ˆì„ì›Œí¬**: Next.js 16 (App Router)
- **ì—ë””í„°**: Novel.sh (Tiptap ê¸°ë°˜) - ê´€ë¦¬ì ë‹µë³€ ì‘ì„±ìš©
- **ë°ì´í„°ë² ì´ìŠ¤**: Supabase (PostgreSQL)
- **ì¸ì¦**: Supabase Auth (ì„ íƒì , ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì í—ˆìš©)
- **ë°°í¬**: Vercel (Frontend), Supabase (Backend)

### 1.2 í•µì‹¬ ê¸°ëŠ¥

1. **ì§ˆë¬¸/ë‹µë³€ ë³´ë“œ ì‹œìŠ¤í…œ**
   - ì´ë²¤íŠ¸(íšŒì°¨)ë³„ ì§ˆë¬¸ ê´€ë¦¬
   - ì‚¬ìš©ì ì§ˆë¬¸ ì‘ì„± (ê²½ëŸ‰ ì—ë””í„° ë˜ëŠ” í…ìŠ¤íŠ¸ ì—ì–´ë¦¬ì–´)
   - ì „ë¬¸ê°€ ë‹µë³€ ì‘ì„± (Novel.sh ì—ë””í„°)
   - ì¹´í…Œê³ ë¦¬ë³„ ë¶„ë¥˜ (Dev, Biz, Ethics ë“±)
   - ì§ˆë¬¸ ì œëª© AI ìë™ ìƒì„±

2. **íˆ¬í‘œ ë° ë­í‚¹ ì‹œìŠ¤í…œ**
   - Upvote/Like ê¸°ë°˜ íˆ¬í‘œ
   - íˆ¬í‘œìˆ˜ ê¸°ë°˜ ì¸ê¸°ìˆœ ì •ë ¬
   - ì¤‘ë³µ íˆ¬í‘œ ë°©ì§€ (ì„¸ì…˜/ì‚¬ìš©ì ê¸°ë°˜)
   - ì‹¤ì‹œê°„ ë­í‚¹ ì—…ë°ì´íŠ¸

3. **ìœ í‹¸ë¦¬í‹° ê¸°ëŠ¥**
   - Markdown í”„ë¡¬í”„íŠ¸ ë³µì‚¬ (ChatGPTìš©)
   - NotebookLM ì—°ë™ ë§í¬
   - ì§ˆë¬¸ ì•„ì¹´ì´ë¹™ ë° ê²€ìƒ‰

4. **ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ**
   - í†µí•© ëŒ€ì‹œë³´ë“œ (KPI, í†µê³„, ì°¨íŠ¸)
   - ì§ˆë¬¸ ê´€ë¦¬ (ë‹µë³€ ëŒ€ê¸° í•„í„°ë§)
   - ë‹µë³€ ì‘ì„± ë° ìˆ˜ì •
   - íŠ¸ë˜í”½ ë¶„ì„

5. **SEO ê´€ë¦¬ ì‹œìŠ¤í…œ**
   - ìë™ sitemap.xml ìƒì„±
   - robots.txt ê´€ë¦¬
   - JSON-LD êµ¬ì¡°í™” ë°ì´í„°

---

## 2. ê¸°ìˆ  ìŠ¤íƒ ë° ì•„í‚¤í…ì²˜

### 2.1 ê¸°ìˆ  ìŠ¤íƒ

#### í”„ë¡ íŠ¸ì—”ë“œ
- **í”„ë ˆì„ì›Œí¬**: Next.js 16 (App Router)
- **ì–¸ì–´**: TypeScript
- **UI ë¼ì´ë¸ŒëŸ¬ë¦¬**: 
  - Tailwind CSS
  - Lucide React (ì•„ì´ì½˜)
  - Recharts (ì°¨íŠ¸)
- **ì—ë””í„°**: 
  - Novel.sh (`novel` íŒ¨í‚¤ì§€) - ê´€ë¦¬ì ë‹µë³€ ì‘ì„±ìš©
  - Tiptap Core (`@tiptap/core`, `@tiptap/react`)
  - Tiptap Extensions (starter-kit, markdown, html ë“±)
  - ì‚¬ìš©ì ì§ˆë¬¸ ì‘ì„±: ì¼ë°˜ Textarea ë˜ëŠ” ê²½ëŸ‰ ì—ë””í„°

#### ë°±ì—”ë“œ
- **ë°ì´í„°ë² ì´ìŠ¤**: Supabase (PostgreSQL)
- **ì¸ì¦**: Supabase Auth (ì„ íƒì )
- **ìŠ¤í† ë¦¬ì§€**: Supabase Storage
- **API**: Next.js API Routes

#### AI ê¸°ëŠ¥
- **AI SDK**: Vercel AI SDK (`ai` íŒ¨í‚¤ì§€)
- **ëª¨ë¸**: Google Gemini 2.0 Flash (`@ai-sdk/google`)
- **ê¸°ëŠ¥**: 
  - ì§ˆë¬¸ ì œëª© ìë™ ìƒì„±
  - ì§ˆë¬¸ ìš”ì•½ ë° ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜

### 2.2 ì•„í‚¤í…ì²˜ íŒ¨í„´

#### 3-Tier Architecture
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client Layer   â”‚  Next.js Frontend (React Components)
â”‚  (UI/UX)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Application     â”‚  Next.js API Routes
â”‚ Layer           â”‚  (Business Logic)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Data Layer     â”‚  Supabase (PostgreSQL + Storage)
â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ë‹¤ì¤‘ í”„ë¡œì íŠ¸ ìŠ¤í‚¤ë§ˆ ë¶„ë¦¬ ì „ëµ
- **Prefix ê¸°ë°˜ ë¶„ë¦¬**: `modu_`, `uslab_`, `ustudio_` ë“±
- **ê°™ì€ Supabase í”„ë¡œì íŠ¸ ë‚´ì—ì„œ ì™„ì „ ë¶„ë¦¬**
- **í…Œì´ë¸”, í•¨ìˆ˜, íŠ¸ë¦¬ê±°, RLS ì •ì±… ëª¨ë‘ prefix ì‚¬ìš©**

### 2.3 íŒŒì¼ êµ¬ì¡°

```
modu-web/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ [lang]/                   # ë‹¤êµ­ì–´ ë¼ìš°íŒ… (ko, en)
â”‚   â”‚   â”œâ”€â”€ board/                # ì§ˆë¬¸ ë³´ë“œ í˜ì´ì§€
â”‚   â”‚   â”‚   â”œâ”€â”€ [event]/          # ì´ë²¤íŠ¸ë³„ ì§ˆë¬¸ ëª©ë¡
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ [id]/         # ì§ˆë¬¸ ìƒì„¸
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx          # ì „ì²´ ì§ˆë¬¸ ëª©ë¡
â”‚   â”‚   â””â”€â”€ page.tsx              # í™ˆí˜ì´ì§€
â”‚   â”œâ”€â”€ admin/                    # ê´€ë¦¬ì í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ dashboard/            # ëŒ€ì‹œë³´ë“œ
â”‚   â”‚   â”œâ”€â”€ questions/            # ì§ˆë¬¸ ê´€ë¦¬
â”‚   â”‚   â”‚   â””â”€â”€ [id]/             # ë‹µë³€ ì‘ì„±/ìˆ˜ì •
â”‚   â”‚   â””â”€â”€ login/                # ë¡œê·¸ì¸
â”‚   â”œâ”€â”€ api/                      # API Routes
â”‚   â”‚   â”œâ”€â”€ questions/            # ì§ˆë¬¸ API
â”‚   â”‚   â”œâ”€â”€ vote/                 # íˆ¬í‘œ API
â”‚   â”‚   â”œâ”€â”€ admin/                # ê´€ë¦¬ì API
â”‚   â”‚   â”œâ”€â”€ ai/                   # AI ê¸°ëŠ¥ API
â”‚   â”‚   â”œâ”€â”€ track/                # íŠ¸ë˜í‚¹ API
â”‚   â”‚   â””â”€â”€ upload/               # íŒŒì¼ ì—…ë¡œë“œ API
â”‚   â”œâ”€â”€ sitemap.ts                # Sitemap ìƒì„±
â”‚   â””â”€â”€ robots.ts                 # Robots.txt ìƒì„±
â”œâ”€â”€ components/                   # React ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ board/                     # ì§ˆë¬¸ ë³´ë“œ ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ admin/                    # ê´€ë¦¬ì ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ editor/                   # ì—ë””í„° ì»´í¬ë„ŒíŠ¸
â”‚   â””â”€â”€ sections/                 # ì„¹ì…˜ ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ lib/                          # ìœ í‹¸ë¦¬í‹° ë° í—¬í¼
â”‚   â”œâ”€â”€ hooks/                    # React Hooks
â”‚   â”œâ”€â”€ queries/                  # ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬
â”‚   â”œâ”€â”€ supabase/                 # Supabase í´ë¼ì´ì–¸íŠ¸
â”‚   â”œâ”€â”€ types/                    # TypeScript íƒ€ì…
â”‚   â”œâ”€â”€ utils/                    # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚   â”‚   â””â”€â”€ markdown.ts            # Markdown í”„ë¡¬í”„íŠ¸ ìƒì„±
â”‚   â””â”€â”€ i18n/                     # ë‹¤êµ­ì–´ ì§€ì›
â”œâ”€â”€ supabase/
â”‚   â””â”€â”€ migrations/               # ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
â””â”€â”€ public/                       # ì •ì  íŒŒì¼
```

---

## 3. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### 3.1 ì§ˆë¬¸/ë‹µë³€ ì‹œìŠ¤í…œ í…Œì´ë¸”

#### `modu_events` (í–‰ì‚¬/íšŒì°¨)

```sql
CREATE TABLE modu_events (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  slug TEXT NOT NULL UNIQUE,             -- ì˜ˆ: 'ai-2025'
  title TEXT NOT NULL,                   -- ì˜ˆ: '2025 AI ê²°ì‚°'
  event_date TIMESTAMPTZ,                -- í–‰ì‚¬ ì¼ì‹œ
  status TEXT DEFAULT 'open',            -- open, live, closed
  notebooklm_url TEXT,                   -- NotebookLM ê³µìœ  ë§í¬
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);

CREATE INDEX modu_idx_events_status ON modu_events(status);
CREATE INDEX modu_idx_events_slug ON modu_events(slug);
```

#### `modu_questions` (ì§ˆë¬¸)

```sql
CREATE TABLE modu_questions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  event_id UUID REFERENCES modu_events(id) ON DELETE CASCADE,
  title TEXT NOT NULL,                   -- ì§ˆë¬¸ ìš”ì•½/ì œëª© (AI ìë™ ìƒì„± ê°€ëŠ¥)
  content TEXT NOT NULL,                 -- ì§ˆë¬¸ ìƒì„¸ ë‚´ìš©
  category TEXT,                         -- ì¹´í…Œê³ ë¦¬ íƒœê·¸ (Dev, Biz, Ethics ë“±)
  
  -- ë‹µë³€ ë° ê´€ë¦¬
  answer TEXT,                           -- ë‹µë³€ ë‚´ìš© (Markdown)
  is_answered BOOLEAN DEFAULT false,     -- ë‹µë³€ ì™„ë£Œ ì—¬ë¶€
  
  -- ë­í‚¹ ì‹œìŠ¤í…œ
  vote_count INTEGER DEFAULT 0,
  
  -- ë©”íƒ€ ì •ë³´
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now(),
  author_id UUID REFERENCES auth.users(id) -- ë¡œê·¸ì¸ ì‚¬ìš©ìì¼ ê²½ìš° (nullable)
);

-- ê²€ìƒ‰ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•œ ì¸ë±ìŠ¤
CREATE INDEX modu_idx_questions_vote ON modu_questions(vote_count DESC);
CREATE INDEX modu_idx_questions_event ON modu_questions(event_id);
CREATE INDEX modu_idx_questions_answered ON modu_questions(is_answered);
CREATE INDEX modu_idx_questions_category ON modu_questions(category);
CREATE INDEX modu_idx_questions_created ON modu_questions(created_at DESC);
```

#### `modu_votes` (íˆ¬í‘œ)

```sql
CREATE TABLE modu_votes (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  question_id UUID REFERENCES modu_questions(id) ON DELETE CASCADE,
  user_id UUID REFERENCES auth.users(id),  -- ë¡œê·¸ì¸ ìœ ì € (nullable)
  session_id TEXT,                         -- ë¹„ë¡œê·¸ì¸ ìœ ì € (ë¸Œë¼ìš°ì € ì¿ í‚¤/IP í•´ì‹œ)
  created_at TIMESTAMPTZ DEFAULT now(),
  UNIQUE(question_id, user_id),            -- íšŒì› ì¤‘ë³µ ë°©ì§€
  UNIQUE(question_id, session_id)          -- ë¹„íšŒì› ì¤‘ë³µ ë°©ì§€
);

CREATE INDEX modu_idx_votes_question ON modu_votes(question_id);
CREATE INDEX modu_idx_votes_user ON modu_votes(user_id);
CREATE INDEX modu_idx_votes_session ON modu_votes(session_id);
```

### 3.2 íŠ¸ë˜í‚¹ ì‹œìŠ¤í…œ í…Œì´ë¸”

#### `modu_sessions` (ì„¸ì…˜)

```sql
CREATE TABLE modu_sessions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  session_key TEXT NOT NULL UNIQUE,      -- í´ë¼ì´ì–¸íŠ¸ ì„¸ì…˜ í‚¤
  landing_path TEXT,                      -- ì²« ìœ ì… ê²½ë¡œ
  referrer TEXT,                         -- ë¦¬í¼ëŸ¬ URL
  referrer_host TEXT,                    -- ë¦¬í¼ëŸ¬ í˜¸ìŠ¤íŠ¸
  utm_source TEXT,                       -- UTM ì†ŒìŠ¤
  utm_medium TEXT,                       -- UTM ë¯¸ë””ì—„
  utm_campaign TEXT,                     -- UTM ìº í˜ì¸
  utm_term TEXT,                         -- UTM í„°ë¯¸ë„
  utm_content TEXT,                      -- UTM ì½˜í…ì¸ 
  user_agent TEXT,                       -- User Agent
  device_type TEXT CHECK (device_type IN ('mobile', 'tablet', 'desktop', 'bot', 'unknown')),
  created_at TIMESTAMPTZ DEFAULT now(),
  last_seen_at TIMESTAMPTZ DEFAULT now()
);

CREATE INDEX modu_idx_sessions_created_at 
  ON modu_sessions(created_at DESC);
CREATE INDEX modu_idx_sessions_referrer_host 
  ON modu_sessions(referrer_host);
```

#### `modu_page_views` (í˜ì´ì§€ë·°)

```sql
CREATE TABLE modu_page_views (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  session_id UUID REFERENCES modu_sessions(id) ON DELETE CASCADE,
  question_id UUID REFERENCES modu_questions(id) ON DELETE SET NULL,
  page_path TEXT NOT NULL,               -- í˜ì´ì§€ ê²½ë¡œ
  locale TEXT CHECK (locale IN ('ko', 'en')),
  view_duration INTEGER,                 -- ì²´ë¥˜ ì‹œê°„ (ì´ˆ)
  scroll_depth INTEGER,                  -- ìŠ¤í¬ë¡¤ ê¹Šì´ (0-100)
  created_at TIMESTAMPTZ DEFAULT now()
);

CREATE INDEX modu_idx_page_views_created_at 
  ON modu_page_views(created_at DESC);
CREATE INDEX modu_idx_page_views_question_id 
  ON modu_page_views(question_id, created_at DESC);
```

### 3.3 RLS (Row Level Security) ì •ì±…

#### ì§ˆë¬¸ RLS

```sql
-- ê³µê°œ ì½ê¸° (ëª¨ë“  ì§ˆë¬¸)
CREATE POLICY modu_policy_questions_select_public
  ON modu_questions FOR SELECT
  USING (true);

-- ëˆ„êµ¬ë‚˜ ì§ˆë¬¸ ì‘ì„± ê°€ëŠ¥ (ë¹„ë¡œê·¸ì¸ í—ˆìš©)
CREATE POLICY modu_policy_questions_insert_public
  ON modu_questions FOR INSERT
  WITH CHECK (true);

-- ì‘ì„±ì ë³¸ì¸ ë˜ëŠ” ê´€ë¦¬ìë§Œ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥
CREATE POLICY modu_policy_questions_update_authenticated
  ON modu_questions FOR UPDATE
  TO authenticated
  USING (author_id = auth.uid() OR auth.uid() IN (SELECT id FROM auth.users WHERE email = 'admin@example.com'))
  WITH CHECK (true);

CREATE POLICY modu_policy_questions_delete_authenticated
  ON modu_questions FOR DELETE
  TO authenticated
  USING (author_id = auth.uid() OR auth.uid() IN (SELECT id FROM auth.users WHERE email = 'admin@example.com'));
```

#### íˆ¬í‘œ RLS

```sql
-- ëˆ„êµ¬ë‚˜ íˆ¬í‘œ ê°€ëŠ¥
CREATE POLICY modu_policy_votes_insert_public
  ON modu_votes FOR INSERT
  WITH CHECK (true);

-- ë³¸ì¸ íˆ¬í‘œë§Œ ì¡°íšŒ ê°€ëŠ¥
CREATE POLICY modu_policy_votes_select_public
  ON modu_votes FOR SELECT
  USING (
    user_id = auth.uid() OR 
    session_id = current_setting('app.session_id', true)
  );
```

#### íŠ¸ë˜í‚¹ RLS

```sql
-- ê´€ë¦¬ìë§Œ ì¡°íšŒ ê°€ëŠ¥
CREATE POLICY modu_policy_sessions_select_authenticated
  ON modu_sessions FOR SELECT
  TO authenticated
  USING (true);

CREATE POLICY modu_policy_page_views_select_authenticated
  ON modu_page_views FOR SELECT
  TO authenticated
  USING (true);
```

### 3.4 íŠ¸ë¦¬ê±° ë° í•¨ìˆ˜

#### `updated_at` ìë™ ì—…ë°ì´íŠ¸

```sql
CREATE OR REPLACE FUNCTION modu_update_question_updated_at()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER modu_trigger_question_updated_at
  BEFORE UPDATE ON modu_questions
  FOR EACH ROW
  EXECUTE FUNCTION modu_update_question_updated_at();
```

#### íˆ¬í‘œìˆ˜ ì¦ê°€ í•¨ìˆ˜

```sql
CREATE OR REPLACE FUNCTION modu_increment_vote_count(question_uuid UUID, session_key TEXT, user_uuid UUID DEFAULT NULL)
RETURNS INTEGER
LANGUAGE plpgsql
SECURITY DEFINER
AS $$
DECLARE
  new_count INTEGER;
  existing_vote UUID;
BEGIN
  -- ì¤‘ë³µ íˆ¬í‘œ ì²´í¬
  IF user_uuid IS NOT NULL THEN
    SELECT id INTO existing_vote
    FROM modu_votes
    WHERE question_id = question_uuid AND user_id = user_uuid;
  ELSE
    SELECT id INTO existing_vote
    FROM modu_votes
    WHERE question_id = question_uuid AND session_id = session_key;
  END IF;
  
  IF existing_vote IS NOT NULL THEN
    RAISE EXCEPTION 'Already voted';
  END IF;
  
  -- íˆ¬í‘œ ê¸°ë¡
  INSERT INTO modu_votes (question_id, user_id, session_id)
  VALUES (question_uuid, user_uuid, session_key);
  
  -- íˆ¬í‘œìˆ˜ ì¦ê°€
  UPDATE modu_questions
  SET vote_count = vote_count + 1
  WHERE id = question_uuid
  RETURNING vote_count INTO new_count;
  
  RETURN COALESCE(new_count, 0);
END;
$$;
```

#### íŠ¸ë˜í‚¹ ë°ì´í„° ì •ë¦¬ í•¨ìˆ˜ (90ì¼ Retention)

```sql
CREATE OR REPLACE FUNCTION modu_cleanup_old_tracking()
RETURNS INTEGER
LANGUAGE plpgsql
SECURITY DEFINER
AS $$
DECLARE
  deleted_pageviews INTEGER;
  deleted_sessions INTEGER;
BEGIN
  -- 90ì¼ ì§€ë‚œ page_views ì‚­ì œ
  DELETE FROM modu_page_views
  WHERE created_at < now() - INTERVAL '90 days';
  
  GET DIAGNOSTICS deleted_pageviews = ROW_COUNT;
  
  -- orphan sessions ì‚­ì œ
  DELETE FROM modu_sessions s
  WHERE s.created_at < now() - INTERVAL '90 days'
    AND NOT EXISTS (
      SELECT 1 FROM modu_page_views pv 
      WHERE pv.session_id = s.id
    );
  
  GET DIAGNOSTICS deleted_sessions = ROW_COUNT;
  
  RETURN deleted_pageviews + deleted_sessions;
END;
$$;
```

---

## 4. ì§ˆë¬¸/ë‹µë³€ ë³´ë“œ ì‹œìŠ¤í…œ

### 4.1 ì§ˆë¬¸ ì‘ì„± í”Œë¡œìš°

#### 1. ì§ˆë¬¸ ì‘ì„± í˜ì´ì§€ (`/board/[event]/write`)

**ì£¼ìš” ê¸°ëŠ¥:**
- ì´ë²¤íŠ¸ ì„ íƒ (ë“œë¡­ë‹¤ìš´)
- ì¹´í…Œê³ ë¦¬ ì„ íƒ (Dev, Biz, Ethics ë“±)
- ì§ˆë¬¸ ë‚´ìš© ì…ë ¥ (Textarea ë˜ëŠ” ê²½ëŸ‰ ì—ë””í„°)
- ì œëª© ìë™ ìƒì„± ì˜µì…˜ (AI)
- ì§ˆë¬¸ ì œì¶œ

**AI ì œëª© ìƒì„±:**
```typescript
// AI ì œëª© ìƒì„± API
POST /api/ai/question-title
{
  "content": "ì§ˆë¬¸ ë‚´ìš©",
  "locale": "ko"
}

// Response
{
  "title": "ìƒì„±ëœ ì§ˆë¬¸ ì œëª©"
}
```

### 4.2 ë‹µë³€ ì‘ì„± í”Œë¡œìš° (ê´€ë¦¬ì)

#### 1. ë‹µë³€ ì‘ì„± í˜ì´ì§€ (`/admin/questions/[id]`)

**ì£¼ìš” ê¸°ëŠ¥:**
- ì§ˆë¬¸ ë‚´ìš© í™•ì¸
- Novel.sh ì—ë””í„°ë¡œ ë‹µë³€ ì‘ì„±
- Markdown í˜•ì‹ìœ¼ë¡œ ì €ì¥
- ë‹µë³€ ì™„ë£Œ ì²˜ë¦¬

**ì—ë””í„° ì»´í¬ë„ŒíŠ¸:**
```typescript
// components/editor/AnswerEditor.tsx
import { EditorRoot, EditorContent } from 'novel';
import { extensions } from './extensions';

export default function AnswerEditor({
  content,
  onChange,
}: {
  content: string | null;
  onChange: (content: string) => void;
}) {
  return (
    <EditorRoot>
      <EditorContent
        extensions={extensions}
        content={content}
        onUpdate={({ editor }) => {
          // Markdownìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì €ì¥
          const markdown = editor.storage.markdown.getMarkdown();
          onChange(markdown);
        }}
      />
    </EditorRoot>
  );
}
```

### 4.3 Markdown í”„ë¡¬í”„íŠ¸ ìƒì„±

#### ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜

```typescript
// lib/utils/markdown.ts
export interface Question {
  id: string;
  title: string;
  content: string;
  answer: string | null;
  category?: string;
  event?: {
    title: string;
  };
}

export const generatePromptMarkdown = (question: Question): string => {
  return `# ì£¼ì œ: ${question.title}

## â“ ì§ˆë¬¸

${question.content}

## ğŸ’¡ ë‹µë³€

${question.answer || 'ë‹µë³€ ëŒ€ê¸° ì¤‘'}

---
*ì¶œì²˜: ëª¨ë‘ì˜íŠ¹ê°• ${question.event?.title || '2025 AI ê²°ì‚°'}*
`;
};

export const copyToClipboard = async (text: string): Promise<boolean> => {
  try {
    await navigator.clipboard.writeText(text);
    return true;
  } catch (err) {
    // Fallback for older browsers
    const textArea = document.createElement('textarea');
    textArea.value = text;
    textArea.style.position = 'fixed';
    textArea.style.opacity = '0';
    document.body.appendChild(textArea);
    textArea.select();
    try {
      document.execCommand('copy');
      document.body.removeChild(textArea);
      return true;
    } catch (err) {
      document.body.removeChild(textArea);
      return false;
    }
  }
};
```

### 4.4 NotebookLM ì—°ë™

#### ì´ë²¤íŠ¸ë³„ NotebookLM ë§í¬

```typescript
// components/board/NotebookLMLink.tsx
export default function NotebookLMLink({ event }: { event: ModuEvent }) {
  if (!event.notebooklm_url) return null;
  
  return (
    <a
      href={event.notebooklm_url}
      target="_blank"
      rel="noopener noreferrer"
      className="inline-flex items-center gap-2 text-cyan-400 hover:text-cyan-300"
    >
      <span>NotebookLMì—ì„œ ë³´ê¸°</span>
      <ExternalLinkIcon className="w-4 h-4" />
    </a>
  );
}
```

---

## 5. íˆ¬í‘œ ë° ë­í‚¹ ì‹œìŠ¤í…œ

### 5.1 íˆ¬í‘œ API

#### íˆ¬í‘œ ì²˜ë¦¬

```typescript
// API Route: /api/vote
export async function POST(request: Request) {
  const { question_id, session_id } = await request.json();
  const supabase = createServerClient();
  
  // ì„¸ì…˜ì—ì„œ ì‚¬ìš©ì ì •ë³´ í™•ì¸
  const { data: { user } } = await supabase.auth.getUser();
  
  const { data, error } = await supabase.rpc('modu_increment_vote_count', {
    question_uuid: question_id,
    session_key: session_id,
    user_uuid: user?.id || null,
  });
  
  if (error) {
    return NextResponse.json({ error: error.message }, { status: 400 });
  }
  
  return NextResponse.json({ vote_count: data });
}
```

### 5.2 ë­í‚¹ ì •ë ¬

#### ì •ë ¬ ì˜µì…˜

```typescript
// lib/queries/questions.ts
export async function getQuestions(params: {
  event_id?: string;
  category?: string;
  sort?: 'hot' | 'new' | 'answered';
  page?: number;
  limit?: number;
}) {
  const supabase = createServerClient();
  let query = supabase
    .from('modu_questions')
    .select('*, modu_events(*)', { count: 'exact' });
  
  if (params.event_id) {
    query = query.eq('event_id', params.event_id);
  }
  
  if (params.category) {
    query = query.eq('category', params.category);
  }
  
  // ì •ë ¬
  switch (params.sort) {
    case 'hot':
      query = query.order('vote_count', { ascending: false });
      break;
    case 'answered':
      query = query.eq('is_answered', true).order('created_at', { ascending: false });
      break;
    case 'new':
    default:
      query = query.order('created_at', { ascending: false });
      break;
  }
  
  // í˜ì´ì§€ë„¤ì´ì…˜
  const page = params.page || 1;
  const limit = params.limit || 10;
  query = query.range((page - 1) * limit, page * limit - 1);
  
  const { data, error, count } = await query;
  
  return {
    questions: data || [],
    total: count || 0,
    page,
    limit,
    totalPages: Math.ceil((count || 0) / limit),
  };
}
```

---

## 6. ì–´ë“œë¯¼ ëŒ€ì‹œë³´ë“œ ì‹œìŠ¤í…œ

### 6.1 ëŒ€ì‹œë³´ë“œ êµ¬ì¡°

#### í™”ë©´ êµ¬ì„±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  KPI ì¹´ë“œ (4-6ê°œ)                        â”‚
â”‚  [ì´ ì§ˆë¬¸] [ë‹µë³€ì™„ë£Œ] [ë‹µë³€ëŒ€ê¸°] [ì´ íˆ¬í‘œ]â”‚
â”‚  [ì˜¤ëŠ˜ ë°©ë¬¸ì] [7ì¼/30ì¼ í†µê³„]           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  íŠ¸ë˜í”½ ì¶”ì´ ì°¨íŠ¸ (7ì¼/30ì¼ í† ê¸€)        â”‚
â”‚  [Line Chart: ì¼ë³„ í˜ì´ì§€ë·°/ë°©ë¬¸ì]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Top ì§ˆë¬¸ / Top ì¹´í…Œê³ ë¦¬ / Top ì´ë²¤íŠ¸    â”‚
â”‚  [í…Œì´ë¸” 3ì—´ ë˜ëŠ” 2í–‰ êµ¬ì„±]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ìµœê·¼ í™œë™                               â”‚
â”‚  [ìµœê·¼ ì§ˆë¬¸] [ë‹µë³€ ëŒ€ê¸° ì§ˆë¬¸]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 KPI ì¹´ë“œ ë°ì´í„°

#### API: `/api/admin/dashboard`

```typescript
// Response
{
  "stats": {
    "totalQuestions": 100,
    "answeredQuestions": 85,
    "pendingQuestions": 15,
    "totalVotes": 5000,
    "todayStats": {
      "pageviews": 500,
      "uniques": 200
    },
    "periodStats": {
      "last7Days": {
        "pageviews": 3000,
        "uniques": 1200
      },
      "last30Days": {
        "pageviews": 15000,
        "uniques": 5000
      }
    }
  },
  "topQuestions": [...],
  "topCategories": [...],
  "topEvents": [...],
  "recentActivity": {
    "recentQuestions": [...],
    "pendingQuestions": [...]
  },
  "dailyStats": {
    "last7Days": [...],
    "last30Days": [...]
  }
}
```

---

## 7. SEO ê´€ë¦¬ ì‹œìŠ¤í…œ

### 7.1 Sitemap.xml ìƒì„±

#### êµ¬í˜„: `app/sitemap.ts`

```typescript
import { MetadataRoute } from 'next';
import { createServerClient } from '@/lib/supabase/client';

export default async function sitemap(): Promise<MetadataRoute.Sitemap> {
  const baseUrl = process.env.NEXT_PUBLIC_SITE_URL || 'https://modulecture.com';
  const supabase = createServerClient();

  // ì§ˆë¬¸ ì¡°íšŒ
  const { data: questions } = await supabase
    .from('modu_questions')
    .select('id, event_id, modu_events(slug)')
    .order('created_at', { ascending: false });

  // ì§ˆë¬¸ URL ìƒì„±
  const questionUrls = (questions || []).map((question) => ({
    url: `${baseUrl}/board/${question.modu_events?.slug}/${question.id}`,
    lastModified: new Date(),
    changeFrequency: 'weekly' as const,
    priority: 0.8,
  }));

  // ì •ì  í˜ì´ì§€ URL
  const staticUrls = [
    {
      url: baseUrl,
      lastModified: new Date(),
      changeFrequency: 'daily',
      priority: 1.0,
    },
    // ... ê¸°íƒ€ ì •ì  í˜ì´ì§€
  ];

  return [...staticUrls, ...questionUrls];
}
```

### 7.2 JSON-LD êµ¬ì¡°í™” ë°ì´í„°

#### FAQPage (ì§ˆë¬¸/ë‹µë³€)

```typescript
// app/board/[event]/[id]/page.tsx
const faqSchema = {
  '@context': 'https://schema.org',
  '@type': 'FAQPage',
  mainEntity: {
    '@type': 'Question',
    name: question.title,
    text: question.content,
    acceptedAnswer: question.answer ? {
      '@type': 'Answer',
      text: question.answer,
    } : undefined,
  },
};

<script
  type="application/ld+json"
  dangerouslySetInnerHTML={{ __html: JSON.stringify(faqSchema) }}
/>
```

---

## 8. ì¸ì¦ ë° ê¶Œí•œ ê´€ë¦¬

### 8.1 ì„ íƒì  ì¸ì¦

#### ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì í—ˆìš©

```typescript
// lib/hooks/useAuth.ts
export function useAuth() {
  const [user, setUser] = useState<User | null>(null);
  const [session, setSession] = useState<Session | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    // ì´ˆê¸° ì„¸ì…˜ í™•ì¸ (ì„ íƒì )
    supabase.auth.getSession().then(({ data: { session } }) => {
      setSession(session);
      setUser(session?.user ?? null);
      setLoading(false);
    });

    // ì¸ì¦ ìƒíƒœ ë³€ê²½ ë¦¬ìŠ¤ë„ˆ
    const {
      data: { subscription },
    } = supabase.auth.onAuthStateChange((_event, session) => {
      setSession(session);
      setUser(session?.user ?? null);
      setLoading(false);
    });

    return () => subscription.unsubscribe();
  }, []);

  return {
    user,
    session,
    loading,
    isAuthenticated: !!user,
    signIn: async (email: string, password: string) => {
      const { data, error } = await supabase.auth.signInWithPassword({
        email,
        password,
      });
      if (error) throw error;
      return data;
    },
    signOut: async () => {
      await supabase.auth.signOut();
    },
  };
}
```

### 8.2 ê´€ë¦¬ì í˜ì´ì§€ ë³´í˜¸

#### ë¯¸ë“¤ì›¨ì–´

```typescript
// middleware.ts
import { createMiddlewareClient } from '@supabase/auth-helpers-nextjs';
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export async function middleware(req: NextRequest) {
  const res = NextResponse.next();
  const supabase = createMiddlewareClient({ req, res });

  const {
    data: { session },
  } = await supabase.auth.getSession();

  // /admin ê²½ë¡œ ë³´í˜¸
  if (req.nextUrl.pathname.startsWith('/admin')) {
    if (!session) {
      return NextResponse.redirect(new URL('/admin/login', req.url));
    }
  }

  return res;
}

export const config = {
  matcher: ['/admin/:path*'],
};
```

---

## 9. íŠ¸ë˜í‚¹ ë° ë¶„ì„ ì‹œìŠ¤í…œ

### 9.1 í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ íŠ¸ë˜í‚¹

#### Tracker ì»´í¬ë„ŒíŠ¸

```typescript
// components/analytics/Tracker.tsx
'use client';

import { useEffect, useRef } from 'react';
import { usePathname } from 'next/navigation';

export default function Tracker() {
  const pathname = usePathname();
  const hasTracked = useRef(false);

  useEffect(() => {
    if (hasTracked.current) return;
    hasTracked.current = true;

    // ì„¸ì…˜ í‚¤ ìƒì„±/ì¡°íšŒ
    let sessionKey = localStorage.getItem('session_key');
    if (!sessionKey) {
      sessionKey = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
      localStorage.setItem('session_key', sessionKey);
    }

    // íŠ¸ë˜í‚¹ ë°ì´í„° ì „ì†¡
    const trackingData = {
      session_key: sessionKey,
      page_path: pathname,
      referrer: document.referrer || null,
      locale: pathname.startsWith('/en') ? 'en' : 'ko',
    };

    // sendBeacon ì‚¬ìš©
    if (navigator.sendBeacon) {
      navigator.sendBeacon(
        '/api/track',
        JSON.stringify(trackingData)
      );
    } else {
      fetch('/api/track', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(trackingData),
        keepalive: true,
      }).catch(() => {});
    }
  }, [pathname]);

  return null;
}
```

---

## 10. API ëª…ì„¸

### 10.1 ì§ˆë¬¸ API

#### ì§ˆë¬¸ ëª©ë¡ ì¡°íšŒ

```
GET /api/questions?page=1&limit=10&event_id=uuid&category=Dev&sort=hot&q=keyword

Query Parameters:
- page: number (ê¸°ë³¸ê°’: 1)
- limit: number (ê¸°ë³¸ê°’: 10)
- event_id: UUID (ì„ íƒ)
- category: string (ì„ íƒ: Dev, Biz, Ethics ë“±)
- sort: 'hot' | 'new' | 'answered' (ê¸°ë³¸ê°’: 'new')
- q: string (ê²€ìƒ‰ í‚¤ì›Œë“œ, ì œëª©+ë‚´ìš© ê²€ìƒ‰)

Response:
{
  "questions": ModuQuestion[],
  "total": number,
  "page": number,
  "limit": number,
  "totalPages": number
}
```

#### ì§ˆë¬¸ ìƒì„¸ ì¡°íšŒ

```
GET /api/questions/[id]

Response:
{
  "question": ModuQuestion
}
```

#### ì§ˆë¬¸ ìƒì„±

```
POST /api/questions

Body:
{
  "event_id": string,
  "title": string,
  "content": string,
  "category"?: string
}

Response:
{
  "question": ModuQuestion
}
```

#### ì§ˆë¬¸ ìˆ˜ì •

```
PUT /api/questions/[id]
Headers:
  Authorization: Bearer <token>

Body:
{
  "title"?: string,
  "content"?: string,
  "category"?: string
}

Response:
{
  "question": ModuQuestion
}
```

#### ì§ˆë¬¸ ì‚­ì œ

```
DELETE /api/questions/[id]
Headers:
  Authorization: Bearer <token>

Response:
{
  "success": boolean
}
```

### 10.2 íˆ¬í‘œ API

#### íˆ¬í‘œí•˜ê¸°

```
POST /api/vote

Body:
{
  "question_id": string,
  "session_id": string
}

Response:
{
  "vote_count": number
}

Error (ì´ë¯¸ íˆ¬í‘œí•œ ê²½ìš°):
{
  "error": "Already voted"
}
```

### 10.3 ë‹µë³€ API

#### ë‹µë³€ ì‘ì„±/ìˆ˜ì •

```
PUT /api/questions/[id]/answer
Headers:
  Authorization: Bearer <token>

Body:
{
  "answer": string  // Markdown í˜•ì‹
}

Response:
{
  "question": ModuQuestion
}
```

### 10.4 AI ê¸°ëŠ¥ API

#### ì§ˆë¬¸ ì œëª© ìë™ ìƒì„±

```
POST /api/ai/question-title
Headers:
  Authorization: Bearer <token>

Body:
{
  "content": string,
  "locale": "ko" | "en"
}

Response:
{
  "title": string
}
```

### 10.5 ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ API

#### ëŒ€ì‹œë³´ë“œ ë°ì´í„° ì¡°íšŒ

```
GET /api/admin/dashboard
Headers:
  Authorization: Bearer <token>

Response:
{
  "stats": {
    "totalQuestions": number,
    "answeredQuestions": number,
    "pendingQuestions": number,
    "totalVotes": number,
    "todayStats": {
      "pageviews": number,
      "uniques": number
    },
    "periodStats": {
      "last7Days": { "pageviews": number, "uniques": number },
      "last30Days": { "pageviews": number, "uniques": number }
    }
  },
  "topQuestions": Array<{ question_id: string, title: string, vote_count: number }>,
  "topCategories": Array<{ category: string, count: number }>,
  "topEvents": Array<{ event_id: string, title: string, question_count: number }>,
  "recentActivity": {
    "recentQuestions": ModuQuestion[],
    "pendingQuestions": ModuQuestion[]
  },
  "dailyStats": {
    "last7Days": DailyStats[],
    "last30Days": DailyStats[]
  }
}
```

---

## 11. í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°

### 11.1 ì§ˆë¬¸ ë³´ë“œ ì»´í¬ë„ŒíŠ¸

#### QuestionCard (ì§ˆë¬¸ ì¹´ë“œ)

```typescript
// components/board/QuestionCard.tsx
'use client';

import { useState } from 'react';
import Link from 'next/link';
import { generatePromptMarkdown, copyToClipboard } from '@/lib/utils/markdown';
import { Heart, Copy, Check } from 'lucide-react';

export default function QuestionCard({ question }: { question: ModuQuestion }) {
  const [voted, setVoted] = useState(false);
  const [copied, setCopied] = useState(false);
  const sessionId = typeof window !== 'undefined' 
    ? localStorage.getItem('session_key') || ''
    : '';

  const handleVote = async () => {
    if (voted) return;
    
    const response = await fetch('/api/vote', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        question_id: question.id,
        session_id: sessionId,
      }),
    });
    
    if (response.ok) {
      setVoted(true);
      // íˆ¬í‘œìˆ˜ ì—…ë°ì´íŠ¸
    }
  };

  const handleCopy = async () => {
    const markdown = generatePromptMarkdown(question);
    const success = await copyToClipboard(markdown);
    if (success) {
      setCopied(true);
      setTimeout(() => setCopied(false), 2000);
    }
  };

  return (
    <div className="bg-slate-900 rounded border border-slate-800 p-6 hover:border-cyan-500 transition">
      <div className="flex justify-between items-start mb-2">
        <div className="flex-1">
          <Link href={`/board/${question.event_id}/${question.id}`}>
            <h3 className="text-xl font-bold text-white mb-2 hover:text-cyan-400">
              {question.title}
            </h3>
          </Link>
          <p className="text-slate-400 text-sm mb-4 line-clamp-2">
            {question.content}
          </p>
        </div>
        <div className="flex gap-2 ml-4">
          <button
            onClick={handleCopy}
            className="p-2 text-slate-400 hover:text-cyan-400 transition"
            title="Markdown ë³µì‚¬"
          >
            {copied ? <Check className="w-5 h-5" /> : <Copy className="w-5 h-5" />}
          </button>
        </div>
      </div>
      
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-4 text-xs text-slate-500">
          {question.category && (
            <span className="px-2 py-1 bg-slate-800 rounded text-slate-300">
              {question.category}
            </span>
          )}
          <span>{formatDate(question.created_at)}</span>
          {question.is_answered && (
            <span className="px-2 py-1 bg-green-900 text-green-300 rounded">
              ë‹µë³€ì™„ë£Œ
            </span>
          )}
        </div>
        
        <button
          onClick={handleVote}
          disabled={voted}
          className={`flex items-center gap-2 px-3 py-1 rounded transition ${
            voted
              ? 'bg-cyan-500 text-white'
              : 'bg-slate-800 text-slate-400 hover:bg-slate-700'
          }`}
        >
          <Heart className={`w-4 h-4 ${voted ? 'fill-current' : ''}`} />
          <span>{question.vote_count}</span>
        </button>
      </div>
    </div>
  );
}
```

#### QuestionForm (ì§ˆë¬¸ ì‘ì„± í¼)

```typescript
// components/board/QuestionForm.tsx
'use client';

import { useState } from 'react';

export default function QuestionForm({ eventId }: { eventId: string }) {
  const [title, setTitle] = useState('');
  const [content, setContent] = useState('');
  const [category, setCategory] = useState('');
  const [autoTitle, setAutoTitle] = useState(false);

  const handleAutoTitle = async () => {
    const response = await fetch('/api/ai/question-title', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ content, locale: 'ko' }),
    });
    const { title } = await response.json();
    setTitle(title);
  };

  const handleSubmit = async (e: FormEvent) => {
    e.preventDefault();
    // ì§ˆë¬¸ ì œì¶œ ë¡œì§
  };

  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      <div>
        <label className="block text-sm font-medium text-slate-300 mb-2">
          ì¹´í…Œê³ ë¦¬
        </label>
        <select
          value={category}
          onChange={(e) => setCategory(e.target.value)}
          className="w-full bg-slate-800 border border-slate-700 rounded px-3 py-2 text-white"
        >
          <option value="">ì„ íƒí•˜ì„¸ìš”</option>
          <option value="Dev">ê°œë°œ</option>
          <option value="Biz">ë¹„ì¦ˆë‹ˆìŠ¤</option>
          <option value="Ethics">ìœ¤ë¦¬</option>
        </select>
      </div>
      
      <div>
        <div className="flex justify-between items-center mb-2">
          <label className="block text-sm font-medium text-slate-300">
            ì œëª©
          </label>
          <button
            type="button"
            onClick={handleAutoTitle}
            disabled={!content}
            className="text-xs text-cyan-400 hover:text-cyan-300"
          >
            AIë¡œ ìƒì„±
          </button>
        </div>
        <input
          type="text"
          value={title}
          onChange={(e) => setTitle(e.target.value)}
          className="w-full bg-slate-800 border border-slate-700 rounded px-3 py-2 text-white"
          placeholder="ì§ˆë¬¸ ì œëª©"
        />
      </div>
      
      <div>
        <label className="block text-sm font-medium text-slate-300 mb-2">
          ì§ˆë¬¸ ë‚´ìš©
        </label>
        <textarea
          value={content}
          onChange={(e) => setContent(e.target.value)}
          rows={8}
          className="w-full bg-slate-800 border border-slate-700 rounded px-3 py-2 text-white"
          placeholder="ì§ˆë¬¸ì„ ì‘ì„±í•´ì£¼ì„¸ìš”..."
        />
      </div>
      
      <button
        type="submit"
        className="w-full bg-cyan-500 hover:bg-cyan-600 text-white font-medium py-2 rounded transition"
      >
        ì§ˆë¬¸ ë“±ë¡
      </button>
    </form>
  );
}
```

### 11.2 ê´€ë¦¬ì ì»´í¬ë„ŒíŠ¸

#### AdminLayout (ê´€ë¦¬ì ë ˆì´ì•„ì›ƒ)

```typescript
// components/admin/AdminLayout.tsx
export default function AdminLayout({ children }: { children: React.ReactNode }) {
  const { user, signOut } = useAuth();

  return (
    <div className="min-h-screen bg-slate-950">
      <nav className="bg-slate-900 border-b border-slate-800">
        <div className="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
          <Link href="/admin/dashboard">ëŒ€ì‹œë³´ë“œ</Link>
          <div className="flex items-center gap-4">
            <span className="text-slate-400">{user?.email}</span>
            <button onClick={signOut}>ë¡œê·¸ì•„ì›ƒ</button>
          </div>
        </div>
      </nav>
      <main>{children}</main>
    </div>
  );
}
```

---

## 12. ì´ì‹ ê°€ì´ë“œ

### 12.1 í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

#### í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜

```env
# Supabase
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# Site
NEXT_PUBLIC_SITE_URL=https://your-domain.com

# AI (Google Gemini)
GOOGLE_API_KEY=your-google-api-key
```

### 12.2 ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

#### 1. Supabase í”„ë¡œì íŠ¸ ìƒì„±/ì—°ê²°

```bash
# Supabase CLI ì„¤ì¹˜ (ì„ íƒ)
npm install -g supabase

# Supabase í”„ë¡œì íŠ¸ ì—°ê²°
supabase link --project-ref your-project-ref
```

#### 2. ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ì‹¤í–‰

```sql
-- 1. ì´ë²¤íŠ¸ í…Œì´ë¸” ìƒì„±
-- supabase/migrations/20250101_create_modu_events.sql

-- 2. ì§ˆë¬¸ í…Œì´ë¸” ìƒì„±
-- supabase/migrations/20250102_create_modu_questions.sql

-- 3. íˆ¬í‘œ í…Œì´ë¸” ìƒì„±
-- supabase/migrations/20250103_create_modu_votes.sql

-- 4. íŠ¸ë˜í‚¹ í…Œì´ë¸” ìƒì„±
-- supabase/migrations/20250115_create_modu_tracking_tables.sql
```

### 12.3 ì½”ë“œ ì´ì‹ ë‹¨ê³„

#### Step 1: ê¸°ë³¸ êµ¬ì¡° ì´ì‹

1. **Next.js í”„ë¡œì íŠ¸ ìƒì„±**
   ```bash
   npx create-next-app@latest your-project --typescript --tailwind --app
   ```

2. **ì˜ì¡´ì„± ì„¤ì¹˜**
   ```bash
   npm install novel @tiptap/core @tiptap/react @tiptap/starter-kit \
     @tiptap/html @tiptap/markdown \
     @supabase/supabase-js ai @ai-sdk/google recharts \
     lucide-react clsx tailwind-merge zod
   ```

3. **íŒŒì¼ êµ¬ì¡° ë³µì‚¬**
   - `app/` ë””ë ‰í† ë¦¬ êµ¬ì¡°
   - `components/` ë””ë ‰í† ë¦¬
   - `lib/` ë””ë ‰í† ë¦¬
   - `supabase/migrations/` ë””ë ‰í† ë¦¬

#### Step 2: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

1. `.env.local` íŒŒì¼ ìƒì„±
2. ìœ„ì˜ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

#### Step 3: ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰

1. Supabase ëŒ€ì‹œë³´ë“œì—ì„œ SQL Editor ì—´ê¸°
2. ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ë“¤ì„ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰

#### Step 4: í…ŒìŠ¤íŠ¸

1. **ì§ˆë¬¸ ì‘ì„± í…ŒìŠ¤íŠ¸**
   - `/board/[event]/write` ì ‘ì†
   - ì§ˆë¬¸ ì‘ì„± ë° ì œì¶œ

2. **íˆ¬í‘œ í…ŒìŠ¤íŠ¸**
   - ì§ˆë¬¸ ëª©ë¡ì—ì„œ íˆ¬í‘œ ë²„íŠ¼ í´ë¦­
   - ì¤‘ë³µ íˆ¬í‘œ ë°©ì§€ í™•ì¸

3. **Markdown ë³µì‚¬ í…ŒìŠ¤íŠ¸**
   - ì§ˆë¬¸ ì¹´ë“œì—ì„œ ë³µì‚¬ ë²„íŠ¼ í´ë¦­
   - í´ë¦½ë³´ë“œì— Markdown í˜•ì‹ìœ¼ë¡œ ë³µì‚¬ë˜ëŠ”ì§€ í™•ì¸

4. **ê´€ë¦¬ì ë‹µë³€ ì‘ì„± í…ŒìŠ¤íŠ¸**
   - `/admin/login` ì ‘ì†
   - ë¡œê·¸ì¸
   - `/admin/questions/[id]` ì ‘ì†
   - Novel.sh ì—ë””í„°ë¡œ ë‹µë³€ ì‘ì„±
   - ë‹µë³€ ì™„ë£Œ ì²˜ë¦¬

### 12.4 ì»¤ìŠ¤í„°ë§ˆì´ì§• ê°€ì´ë“œ

#### ì¹´í…Œê³ ë¦¬ ì¶”ê°€

```sql
-- ì¹´í…Œê³ ë¦¬ëŠ” ììœ  í…ìŠ¤íŠ¸ì´ë¯€ë¡œ ë³„ë„ í…Œì´ë¸” ë¶ˆí•„ìš”
-- í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë“œë¡­ë‹¤ìš´ ì˜µì…˜ìœ¼ë¡œ ê´€ë¦¬
```

#### ì´ë²¤íŠ¸ ìƒíƒœ ê´€ë¦¬

```typescript
// lib/types/event.ts
export type EventStatus = 'open' | 'live' | 'closed';

// ì´ë²¤íŠ¸ ìƒíƒœì— ë”°ë¥¸ ì§ˆë¬¸ ì‘ì„± ì œí•œ
if (event.status === 'closed') {
  // ì§ˆë¬¸ ì‘ì„± ë¶ˆê°€
}
```

### 12.5 ì£¼ì˜ì‚¬í•­

1. **Supabase í”„ë¡œì íŠ¸ êµ¬ì¡°**
   - ê°™ì€ Supabase í”„ë¡œì íŠ¸ ë‚´ì—ì„œ ì—¬ëŸ¬ ì›¹ì‚¬ì´íŠ¸ë¥¼ ìš´ì˜í•˜ëŠ” ê²½ìš°, prefixë¡œ ì™„ì „ ë¶„ë¦¬ í•„ìˆ˜
   - RLS ì •ì±…ë„ prefixë¡œ êµ¬ë¶„

2. **í™˜ê²½ ë³€ìˆ˜ ë³´ì•ˆ**
   - `SUPABASE_SERVICE_ROLE_KEY`ëŠ” ì ˆëŒ€ í´ë¼ì´ì–¸íŠ¸ì— ë…¸ì¶œ ê¸ˆì§€
   - `.env.local`ì€ `.gitignore`ì— í¬í•¨

3. **AI API ë¹„ìš©**
   - Google Gemini API ì‚¬ìš©ëŸ‰ ëª¨ë‹ˆí„°ë§
   - Rate limiting ê³ ë ¤

4. **íŠ¸ë˜í‚¹ ë°ì´í„° Retention**
   - 90ì¼ ìë™ ì‚­ì œ í•¨ìˆ˜ (`modu_cleanup_old_tracking`) ì •ê¸° ì‹¤í–‰ í•„ìš”
   - Vercel Cron ë˜ëŠ” Supabase Scheduled Triggers ì‚¬ìš©

5. **ì„¸ì…˜ ê´€ë¦¬**
   - ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ìì˜ ì„¸ì…˜ IDëŠ” localStorageì— ì €ì¥
   - ì¤‘ë³µ íˆ¬í‘œ ë°©ì§€ë¥¼ ìœ„í•œ ì„¸ì…˜ ê¸°ë°˜ ì²´í¬ í•„ìˆ˜

---

## ë¶€ë¡ A: ì£¼ìš” íŒŒì¼ ëª©ë¡

### ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜
- `supabase/migrations/20250101_create_modu_events.sql`
- `supabase/migrations/20250102_create_modu_questions.sql`
- `supabase/migrations/20250103_create_modu_votes.sql`
- `supabase/migrations/20250115_create_modu_tracking_tables.sql`

### API Routes
- `app/api/questions/route.ts`
- `app/api/questions/[id]/route.ts`
- `app/api/questions/[id]/answer/route.ts`
- `app/api/vote/route.ts`
- `app/api/ai/question-title/route.ts`
- `app/api/track/route.ts`
- `app/api/admin/dashboard/route.ts`

### ì»´í¬ë„ŒíŠ¸
- `components/board/QuestionCard.tsx`
- `components/board/QuestionForm.tsx`
- `components/board/NotebookLMLink.tsx`
- `components/editor/AnswerEditor.tsx`
- `components/admin/AdminLayout.tsx`
- `components/analytics/Tracker.tsx`

### ìœ í‹¸ë¦¬í‹°
- `lib/queries/questions.ts`
- `lib/queries/analytics.ts`
- `lib/utils/markdown.ts`
- `lib/utils/tracking.ts`
- `lib/supabase/client.ts`

---

## ë¶€ë¡ B: ì°¸ê³  ìë£Œ

- [Next.js ê³µì‹ ë¬¸ì„œ](https://nextjs.org/docs)
- [Novel.sh ë¬¸ì„œ](https://novel.sh)
- [Tiptap ë¬¸ì„œ](https://tiptap.dev)
- [Supabase ë¬¸ì„œ](https://supabase.com/docs)
- [Vercel AI SDK ë¬¸ì„œ](https://sdk.vercel.ai/docs)

---

**ë¬¸ì„œ ë²„ì „**: v1.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-01-XX  
**ì‘ì„±ì**: AI Assistant  
**ë³€ê²½ ì´ë ¥**:
- v1.0: ì´ˆê¸° ë²„ì „ (ëª¨ë‘ì˜íŠ¹ê°• í”Œë«í¼ ë§ì¶¤í˜•)



