좋아요. “매 회차 200개”가 아니라 **500개(제한 없음)**까지 열어두면, 지금 보드 UX(검색/정렬/카테고리)  만으로는 금방 **중복 질문이 난립**해서 운영이 힘들어져요. 그래서 말씀하신 **유사 질문 묶기(클러스터링)** 기능을 “회차 기본 기능”으로 넣는 게 맞습니다.

아래는 **Cursor에 바로 던질 수 있는 수준으로** “유사질문 묶기”를 기존 구조에 자연스럽게 추가하는 설계안입니다.

---

## 1) 핵심 컨셉: 질문은 “원본” 그대로 저장 + “그룹”으로 묶어서 보여준다

* 질문은 계속 `modu_questions`에 **원본 그대로** 저장 (500개든 2000개든 OK)
* 유사 질문은 별도 엔티티 `modu_question_groups`로 묶음
* 보드 기본 화면은 **그룹 카드**를 먼저 보여주고(대표질문 + n개 묶임), 클릭하면 **그룹 상세(원본 질문 목록)**이 펼쳐짐

> 운영 목표: “중복 질문을 삭제”가 아니라, “묶어서 정리”하는 구조

---

## 2) DB 설계 추가(추천): 그룹/멤버십/대표질문

### 2.1 `modu_question_groups` (회차별 유사질문 그룹)

* `id uuid PK`
* `event_id uuid FK`
* `canonical_question_id uuid` (대표 질문)
* `title text` (대표 제목/요약)
* `category text` (그룹 카테고리)
* `tags text[]`
* `item_count int` (캐시)
* `vote_count int` (그룹 합산 캐시)
* `status text` (`active|merged|hidden`)
* `created_at/updated_at`

### 2.2 `modu_question_group_items` (그룹에 포함된 질문들)

* `group_id uuid FK`
* `question_id uuid FK`
* `similarity float` (대표 질문과의 유사도)
* `is_canonical boolean` (대표인지)
* `created_at`

> 이렇게 하면 “그룹 만들기/해제/대표 바꾸기”가 운영 UI에서 쉬워져요.

---

## 3) 유사도 계산 방식(현실적으로 가장 안정적인 루트)

### 옵션 A: 임베딩 + 벡터 검색(추천)

* 질문(제목+본문)에 대해 embedding 생성 → `modu_questions.embedding vector`
* Supabase Postgres + pgvector로

  * 새 질문이 들어오면, 같은 event_id 내에서 **가까운 질문 topK** 검색
  * 임계값 이상이면 해당 그룹에 자동 편입
  * 아니면 새 그룹 생성

**장점**

* 500개~수천개까지 잘 버팀
* 자동 묶기 품질이 좋음

**필수 컬럼**

* `modu_questions.embedding vector(1536)` (모델에 따라 차원 조정)
* `modu_questions.group_id uuid nullable` (빠른 조회용 캐시로 두어도 됨)

### 옵션 B: 텍스트 유사도(빠른 MVP)

* trigram similarity(pg_trgm)로 title/content 비교
* 품질은 임베딩보다 낮지만 “일단 자동묶기”는 가능

---

## 4) 운영 UX(어드민): “자동 + 수동 보정”이 핵심

자동만 믿으면 방송 직전엔 꼭 틀어집니다. 그래서 운영 기능은 아래 4개가 필수예요.

1. **[자동 묶기 실행] 버튼**

   * 업로드 후 한 번에 전체 질문을 클러스터링
   * “임계값(예: 0.82)” 슬라이더 제공

2. **그룹 병합(Merge)**

   * 그룹 A + 그룹 B → 그룹 A로 병합
   * 대표 질문 재선정 가능

3. **그룹 분리(Split)**

   * 그룹 안에서 일부 질문만 떼어내 새 그룹 생성

4. **대표 질문 변경(Set Canonical)**

   * 방송에서 보여줄 대표 질문을 운영자가 고를 수 있어야 함

---

## 5) 사용자 보드 UX: “그룹 카드”가 기본, 원본은 펼침

현재 카드형 리스트 UI(qna.html)  를 그대로 살리면서, 카드의 단위를 “질문”에서 “그룹”으로 바꾸면 됩니다.

### 그룹 카드에 표시할 것

* 대표 제목/요약
* 카테고리/태그
* “유사 질문 n개” 배지
* 투표수(그룹 합산)
* (선택) “대표 질문 보기 / 유사 질문 펼치기”

### 투표는 어떻게?

* **추천: 그룹에 투표(1표)**

  * 사용자 입장: “이 주제 중요해요”에 투표하는 느낌이 자연스러움
  * DB: vote는 group_id 기준으로 중복 방지
* (대안) 질문별 투표 유지 + 그룹 합산만 표시

  * 구현 복잡도/운영 혼란이 늘어남

---

## 6) 방송 프롬프터(송출) 적용: “대표 질문만” 슬라이드로

방송 화면은 1장에 1개만 크게 보여주는 구조니까(프로토타입도 그렇게 되어 있음 ), 방송 송출 대상은:

* **그룹(=대표 질문) 리스트**를 `sort_order`로 관리
* 슬라이드 하단에 “유사 질문 n개”를 작은 글씨로 힌트로만 보여주거나,
* Control 화면에서 “유사 질문 펼치기(썸네일/목록)”로 참고 가능

---

## 7) 구현 순서(현실적인 MVP → 고도화 로드맵)

### MVP (빠르게)

1. 그룹 테이블 2개 추가
2. 업로드 후 “자동 묶기(텍스트 유사도)” 실행
3. 보드는 그룹 리스트 기반으로 보여주기
4. 방송은 그룹(대표 질문)만 송출

### 고도화

5. 임베딩 기반 자동 묶기(pgvector)
6. 운영자 수동 병합/분리 UI
7. 그룹 단위 투표로 전환 + “원본 질문 참고” UX 강화

---

원하면, 다음을 바로 만들어 드릴게요(커서 투입용):

* **DB 마이그레이션 SQL (groups / group_items / embedding 컬럼 / 인덱스)**
* **“자동 묶기” API 설계** (`/api/admin/groups/cluster`)
* **Admin 화면 와이어프레임**(그룹 병합/분리/대표 지정)
* **보드/방송에서 그룹 렌더링 컴포넌트 구조**

바로 이어서 “MVP는 텍스트 유사도”로 갈지, “처음부터 임베딩”으로 갈지 정해서(저는 **처음부터 임베딩 추천**) 그 기준으로 명세를 완성해줄게요.
